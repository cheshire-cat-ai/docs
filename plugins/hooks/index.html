
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://cheshire-cat-ai.github.io/docs/plugins/hooks/" rel="canonical"/>
<link href="../tools/" rel="prev"/>
<link href="../forms/" rel="next"/>
<link href="../../assets/img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.0" name="generator"/>
<title>Hooks - Cheshire Cat AI docs</title>
<link href="../../assets/stylesheets/main.618322db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#hooks">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Cheshire Cat AI docs" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Cheshire Cat AI docs">
<img alt="logo" src="../../assets/img/cheshire-cat-logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Cheshire Cat AI docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Hooks
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/cheshire-cat-ai/core" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../quickstart/introduction/">
          
  
  
    
  
  Quickstart

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../plugins/">
          
  
  
    
  
  Plugins

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../framework/cat-components/cheshire_cat/core/">
          
  
  
    
  
  Framework

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../production/administrators/make_the_cat_private/">
          
  
  
    
  
  Administration

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../faq/general/">
          
  
  
    
  
  FAQ

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Cheshire Cat AI docs" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Cheshire Cat AI docs">
<img alt="logo" src="../../assets/img/cheshire-cat-logo.svg"/>
</a>
    Cheshire Cat AI docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/cheshire-cat-ai/core" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Quickstart
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/introduction/">
<span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/installation-configuration/">
<span class="md-ellipsis">
    
  
    Installation and First Configuration
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/play-with-the-cat/">
<span class="md-ellipsis">
    
  
    Playing with the Cat
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/upload-document/">
<span class="md-ellipsis">
    
  
    Uploading a Document
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/installing-plugin/">
<span class="md-ellipsis">
    
  
    Installing a Plugin
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/prepare-plugin/">
<span class="md-ellipsis">
    
  
    Creating a Plugin
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/writing-tool/">
<span class="md-ellipsis">
    
  
    Writing the first Tool
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/writing-hook/">
<span class="md-ellipsis">
    
  
    Writing the first Hook
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/conclusion/">
<span class="md-ellipsis">
    
  
    Conclusion
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Plugins
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../plugins/">
<span class="md-ellipsis">
    
  
    How to Write a Plugin
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tools/">
<span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    Hooks
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    Hooks
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#available-hooks">
<span class="md-ellipsis">
      
        Available Hooks
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-the-hooks-work">
<span class="md-ellipsis">
      
        How the Hooks work
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hook-declaration">
<span class="md-ellipsis">
      
        Hook declaration
      
    </span>
</a>
<nav aria-label="Hook declaration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hook-arguments">
<span class="md-ellipsis">
      
        Hook arguments
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
<span class="md-ellipsis">
      
        Examples
      
    </span>
</a>
<nav aria-label="Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#before-cat-bootstrap">
<span class="md-ellipsis">
      
        Before cat bootstrap
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#before-cat-sends-message">
<span class="md-ellipsis">
      
        Before cat sends message
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hooks-chaining-and-priority">
<span class="md-ellipsis">
      
        Hooks chaining and priority
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-hooks-in-plugins">
<span class="md-ellipsis">
      
        Custom hooks in plugins
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../forms/">
<span class="md-ellipsis">
    
  
    Forms
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../endpoints/">
<span class="md-ellipsis">
    
  
    Custom Endpoints
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../logging/">
<span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../settings/">
<span class="md-ellipsis">
    
  
    Settings
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dependencies/">
<span class="md-ellipsis">
    
  
    Dependencies
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../examples/">
<span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="">
<span class="md-ellipsis">
    
  
    Hooks API Reference
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_10">
<span class="md-nav__icon md-icon"></span>
            
  
    Hooks API Reference
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10_1" id="__nav_2_10_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Flow
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_10_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Flow
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_reads_message/">
<span class="md-ellipsis">
    
  
    before_cat_reads_message
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/cat_recall_query/">
<span class="md-ellipsis">
    
  
    cat_recall_query
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_recalls_memories/">
<span class="md-ellipsis">
    
  
    before_cat_recalls_memories
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_recalls_episodic_memories/">
<span class="md-ellipsis">
    
  
    before_cat_recalls_episodic_memories
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_recalls_declarative_memories/">
<span class="md-ellipsis">
    
  
    before_cat_recalls_declarative_memories
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_recalls_procedural_memories/">
<span class="md-ellipsis">
    
  
    before_cat_recalls_procedural_memories
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/after_cat_recalls_memories/">
<span class="md-ellipsis">
    
  
    after_cat_recalls_memories
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_stores_episodic_memory/">
<span class="md-ellipsis">
    
  
    before_cat_stores_episodic_memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/flow/before_cat_sends_message/">
<span class="md-ellipsis">
    
  
    before_cat_sends_message
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10_2" id="__nav_2_10_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Agent
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_10_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Agent
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/agent/before_agent_starts/">
<span class="md-ellipsis">
    
  
    before_agent_starts
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/agent/agent_fast_reply/">
<span class="md-ellipsis">
    
  
    agent_fast_reply
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/agent/agent_allowed_tools/">
<span class="md-ellipsis">
    
  
    agent_allowed_tools
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/agent/agent_prompt_prefix/">
<span class="md-ellipsis">
    
  
    agent_prompt_prefix
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/agent/agent_prompt_suffix/">
<span class="md-ellipsis">
    
  
    agent_prompt_suffix
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10_3" id="__nav_2_10_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Rabbit Hole
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_10_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Rabbit Hole
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/rabbithole_instantiates_parsers/">
<span class="md-ellipsis">
    
  
    rabbithole_instantiates_parsers
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/rabbithole_instantiates_splitter/">
<span class="md-ellipsis">
    
  
    rabbithole_instantiates_splitter
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/before_rabbithole_insert_memory/">
<span class="md-ellipsis">
    
  
    before_rabbithole_insert_memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/before_rabbithole_splits_text/">
<span class="md-ellipsis">
    
  
    before_rabbithole_splits_text
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/after_rabbithole_splitted_text/">
<span class="md-ellipsis">
    
  
    after_rabbithole_splitted_text
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/before_rabbithole_stores_documents/">
<span class="md-ellipsis">
    
  
    before_rabbithole_stores_documents
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/rabbit-hole/after_rabbithole_stored_documents/">
<span class="md-ellipsis">
    
  
    after_rabbithole_stored_documents
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10_4" id="__nav_2_10_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Factory
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_10_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Factory
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/factory/factory_allowed_llms/">
<span class="md-ellipsis">
    
  
    factory_allowed_llms
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/factory/factory_allowed_embedders/">
<span class="md-ellipsis">
    
  
    factory_allowed_embedders
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/factory/factory_allowed_auth_handlers/">
<span class="md-ellipsis">
    
  
    factory_allowed_auth_handlers
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_10_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10_5" id="__nav_2_10_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_10_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_10_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Lifecycle
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/lifecycle/before_cat_bootstrap/">
<span class="md-ellipsis">
    
  
    before_cat_bootstrap
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hooks-reference/lifecycle/after_cat_bootstrap/">
<span class="md-ellipsis">
    
  
    after_cat_bootstrap
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="">
<span class="md-ellipsis">
    
  
    Python Reference
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_11">
<span class="md-nav__icon md-icon"></span>
            
  
    Python Reference
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_1" id="__nav_2_11_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    agents
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_1">
<span class="md-nav__icon md-icon"></span>
            
  
    agents
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/agents/base_agent/">
<span class="md-ellipsis">
    
  
    base_agent
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/agents/form_agent/">
<span class="md-ellipsis">
    
  
    form_agent
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/agents/main_agent/">
<span class="md-ellipsis">
    
  
    main_agent
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/agents/memory_agent/">
<span class="md-ellipsis">
    
  
    memory_agent
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/agents/procedures_agent/">
<span class="md-ellipsis">
    
  
    procedures_agent
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_2" id="__nav_2_11_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    auth
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_2">
<span class="md-nav__icon md-icon"></span>
            
  
    auth
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/auth/auth_utils/">
<span class="md-ellipsis">
    
  
    auth_utils
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/log/">
<span class="md-ellipsis">
    
  
    log
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_4" id="__nav_2_11_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    looking_glass
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_4">
<span class="md-nav__icon md-icon"></span>
            
  
    looking_glass
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/looking_glass/cheshire_cat/">
<span class="md-ellipsis">
    
  
    cheshire_cat
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/looking_glass/stray_cat/">
<span class="md-ellipsis">
    
  
    stray_cat
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_5" id="__nav_2_11_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    mad_hatter
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_5">
<span class="md-nav__icon md-icon"></span>
            
  
    mad_hatter
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_5_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_5_1" id="__nav_2_11_5_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    core_plugin
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_5_1_label" class="md-nav" data-md-level="4">
<label class="md-nav__title" for="__nav_2_11_5_1">
<span class="md-nav__icon md-icon"></span>
            
  
    core_plugin
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_5_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_5_1_1" id="__nav_2_11_5_1_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    hooks
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_5_1_1_label" class="md-nav" data-md-level="5">
<label class="md-nav__title" for="__nav_2_11_5_1_1">
<span class="md-nav__icon md-icon"></span>
            
  
    hooks
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/core_plugin/hooks/agent/">
<span class="md-ellipsis">
    
  
    agent
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/core_plugin/hooks/flow/">
<span class="md-ellipsis">
    
  
    flow
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/core_plugin/hooks/prompt/">
<span class="md-ellipsis">
    
  
    prompt
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/core_plugin/hooks/rabbithole/">
<span class="md-ellipsis">
    
  
    rabbithole
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/mad_hatter/">
<span class="md-ellipsis">
    
  
    mad_hatter
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/mad_hatter/plugin/">
<span class="md-ellipsis">
    
  
    plugin
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_6" id="__nav_2_11_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    memory
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_6">
<span class="md-nav__icon md-icon"></span>
            
  
    memory
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/memory/vector_memory/">
<span class="md-ellipsis">
    
  
    vector_memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/memory/vector_memory_collection/">
<span class="md-ellipsis">
    
  
    vector_memory_collection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/memory/working_memory/">
<span class="md-ellipsis">
    
  
    working_memory
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/rabbit_hole/">
<span class="md-ellipsis">
    
  
    rabbit_hole
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_11_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11_8" id="__nav_2_11_8_label" tabindex="0">
<span class="md-ellipsis">
    
  
    routes
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_11_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_11_8">
<span class="md-nav__icon md-icon"></span>
            
  
    routes
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/routes/settings/">
<span class="md-ellipsis">
    
  
    settings
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../API_Documentation/utils/">
<span class="md-ellipsis">
    
  
    utils
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="">
<span class="md-ellipsis">
    
  
    Registry
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_12_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_12">
<span class="md-nav__icon md-icon"></span>
            
  
    Registry
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../plugins-registry/plugin-from-template/">
<span class="md-ellipsis">
    
  
    Using the Plugin Template
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../plugins-registry/publishing-plugin/">
<span class="md-ellipsis">
    
  
    Publishing a Plugin
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_13" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="">
<span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_13_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_13">
<span class="md-nav__icon md-icon"></span>
            
  
    Debugging
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../debugging/vscode/">
<span class="md-ellipsis">
    
  
    Visual Studio Code
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Framework
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Framework
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Cat Components
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Cat Components
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/core/">
<span class="md-ellipsis">
    
  
    The Core
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/stray_cat/">
<span class="md-ellipsis">
    
  
    The Stray Cat
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    The Agent
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_3">
<span class="md-nav__icon md-icon"></span>
            
  
    The Agent
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/agent/">
<span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/tool_chain/">
<span class="md-ellipsis">
    
  
    Procedures Chain
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/memory_chain/">
<span class="md-ellipsis">
    
  
    Memory Chain
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    The Prompts
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_4">
<span class="md-nav__icon md-icon"></span>
            
  
    The Prompts
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/prompts/main_prompt/">
<span class="md-ellipsis">
    
  
    Main Prompt
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/prompts/instructions/">
<span class="md-ellipsis">
    
  
    Instruction Prompt
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    The Vector Memory
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_5">
<span class="md-nav__icon md-icon"></span>
            
  
    The Vector Memory
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/vector_memory/">
<span class="md-ellipsis">
    
  
    Vector Memory Collections
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    The Long Term Memory
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_6">
<span class="md-nav__icon md-icon"></span>
            
  
    The Long Term Memory
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/long_term_memory/">
<span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/episodic_memory/">
<span class="md-ellipsis">
    
  
    Episodic Memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/declarative_memory/">
<span class="md-ellipsis">
    
  
    Declarative Memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/procedural_memory/">
<span class="md-ellipsis">
    
  
    Procedural Memory
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/memory/working_memory/">
<span class="md-ellipsis">
    
  
    The Working Memory
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/rabbit_hole/">
<span class="md-ellipsis">
    
  
    The Rabbit Hole
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/white_rabbit/">
<span class="md-ellipsis">
    
  
    The White Rabbit
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/cat-components/cheshire_cat/mad_hatter/">
<span class="md-ellipsis">
    
  
    The Mad Hatter
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Technical Diagrams
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Technical Diagrams
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/flows/cat-bootstrap/">
<span class="md-ellipsis">
    
  
    The Cat Bootstrap
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/flows/chatting-with-the-cat/">
<span class="md-ellipsis">
    
  
    Chatting with the Cat
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/flows/plugins-lifecycle/">
<span class="md-ellipsis">
    
  
    Plugins Lifecycle
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../framework/flows/rabbit-hole-ingestion/">
<span class="md-ellipsis">
    
  
    Rabbit Hole Ingestion
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Administration
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Administration
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/administrators/make_the_cat_private/">
<span class="md-ellipsis">
    
  
    Make the Cat Private
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/administrators/docker-compose/">
<span class="md-ellipsis">
    
  
    Docker Compose
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/administrators/env-variables/">
<span class="md-ellipsis">
    
  
    Environment Variables
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/administrators/tests/">
<span class="md-ellipsis">
    
  
    Automatic Tests
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/administrators/backups-updates/">
<span class="md-ellipsis">
    
  
    Backups and Updates
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Network
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_6">
<span class="md-nav__icon md-icon"></span>
            
  
    Network
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/network/ws-endpoints/">
<span class="md-ellipsis">
    
  
    WebSocket Endpoints
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/network/http-endpoints/">
<span class="md-ellipsis">
    
  
    HTTP Endpoints
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/network/clients/">
<span class="md-ellipsis">
    
  
    Clients
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Auth
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_7">
<span class="md-nav__icon md-icon"></span>
            
  
    Auth
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/auth/authentication/">
<span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/auth/authorization/">
<span class="md-ellipsis">
    
  
    Authorization
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/auth/user-management/">
<span class="md-ellipsis">
    
  
    User Management
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../production/auth/custom-auth/">
<span class="md-ellipsis">
    
  
    Custom Auth
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    FAQ
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/general/">
<span class="md-ellipsis">
    
  
    General
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/basic_info/">
<span class="md-ellipsis">
    
  
    Basic Info
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/errors/">
<span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/customization/">
<span class="md-ellipsis">
    
  
    Customization
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/security_and_spending/">
<span class="md-ellipsis">
    
  
    Security &amp; Spending
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_6">
<span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/llm-concepts/llm/">
<span class="md-ellipsis">
    
  
    Language Models
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/llm-concepts/rag/">
<span class="md-ellipsis">
    
  
    Retrieval Augmented Generation
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/llm-concepts/prompt/">
<span class="md-ellipsis">
    
  
    Prompt
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/llm-concepts/embedder/">
<span class="md-ellipsis">
    
  
    Encoder
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/llm-concepts/vector-memory/">
<span class="md-ellipsis">
    
  
    Vector Memory
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#available-hooks">
<span class="md-ellipsis">
      
        Available Hooks
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-the-hooks-work">
<span class="md-ellipsis">
      
        How the Hooks work
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hook-declaration">
<span class="md-ellipsis">
      
        Hook declaration
      
    </span>
</a>
<nav aria-label="Hook declaration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hook-arguments">
<span class="md-ellipsis">
      
        Hook arguments
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
<span class="md-ellipsis">
      
        Examples
      
    </span>
</a>
<nav aria-label="Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#before-cat-bootstrap">
<span class="md-ellipsis">
      
        Before cat bootstrap
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#before-cat-sends-message">
<span class="md-ellipsis">
      
        Before cat sends message
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hooks-chaining-and-priority">
<span class="md-ellipsis">
      
        Hooks chaining and priority
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-hooks-in-plugins">
<span class="md-ellipsis">
      
        Custom hooks in plugins
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<div><h1 id="hooks"> Hooks</h1>
<p>During execution the Cat emits a few events, for example when a user message arrives, or when a new document is uploaded to memory.
You can <code>hook</code> these events to execute your own code and change behavior, memory and anything the Cat does.</p>
<p>The <a href="../../framework/flows/cat-bootstrap/"><code>Framework  Technical Diagrams</code></a> section illustrates with a diagram where the hooks are called during the Cat's execution flow.
Not all the hooks have been documented yet. ( <a href="https://discord.com/channels/1092359754917089350/1092360068269359206" target="_blank">help needed! </a> ).</p>
<h2 id="available-hooks">Available Hooks</h2>
<p>Here is a list of availble hooks. Each has a dedicated page with examples (see <code>Hooks API Reference</code> on the left menu).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><input id="__tabbed_1_2" name="__tabbed_1" type="radio"/><input id="__tabbed_1_3" name="__tabbed_1" type="radio"/><input id="__tabbed_1_4" name="__tabbed_1" type="radio"/><input id="__tabbed_1_5" name="__tabbed_1" type="radio"/><input id="__tabbed_1_6" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="__tabbed_1_1"> Main Flow</label><label for="__tabbed_1_2"> Agent</label><label for="__tabbed_1_3"> Rabbit Hole</label><label for="__tabbed_1_4"> Plugin</label><label for="__tabbed_1_5"> Factory</label><label for="__tabbed_1_6"> Lifecycle</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    C(before_cat_reads_message)
    D(cat_recall_query)
    E(before_cat_recalls_memories)
    F(before_cat_recalls_episodic_memories)
    G(before_cat_recalls_declarative_memories)
    H(before_cat_recalls_procedural_memories)
    I(after_cat_recalls_memories)
    J(before_cat_stores_episodic_memory)
    K(before_cat_sends_message)

    C--&gt;D
    D--&gt;E
    E--&gt;F
    E--&gt;G
    E--&gt;H
    F--&gt;I
    G--&gt;I
    H--&gt;I
    I-- Main Agent execution --&gt;J
    J--&gt;K

    click C "/docs/plugins/hooks-reference/flow/before_cat_reads_message"
    click D "/docs/plugins/hooks-reference/flow/cat_recall_query"
    click E "/docs/plugins/hooks-reference/flow/before_cat_recalls_memories"
    click F "/docs/plugins/hooks-reference/flow/before_cat_recalls_episodic_memories"
    click G "/docs/plugins/hooks-reference/flow/before_cat_recalls_declarative_memories"
    click H "/docs/plugins/hooks-reference/flow/before_cat_recalls_procedural_memories"
    click I "/docs/plugins/hooks-reference/flow/after_cat_recalls_memories"
    click J "/docs/plugins/hooks-reference/flow/before_cat_stores_episodic_memory"
    click K "/docs/plugins/hooks-reference/flow/before_cat_sends_message"</code></pre>
</div>
<div class="tabbed-block">
<pre class="mermaid"><code>    flowchart TD
        A(before_agent_starts)
        B(agent_fast_reply)
        C(agent_allowed_tools)
        D(agent_prompt_prefix)
        E(agent_prompt_suffix)

        A --&gt; B
        B --&gt; C
        C --&gt; D
        D --&gt; E

        click A "/docs/plugins/hooks-reference/agent/before_agent_starts"
        click B "/docs/plugins/hooks-reference/agent/agent_fast_reply"
        click C "/docs/plugins/hooks-reference/agent/agent_allowed_tools"
        click D "/docs/plugins/hooks-reference/agent/agent_prompt_prefix"
        click E "/docs/plugins/hooks-reference/agent/agent_prompt_suffix"</code></pre>
</div>
<div class="tabbed-block">
<pre class="mermaid"><code>    flowchart TD
        subgraph Ingestion
            A(before_rabbithole_insert_memory)
            B(before_rabbithole_splits_text)
            C(after_rabbithole_splitted_text)
            D(before_rabbithole_stores_documents)
            E(after_rabbithole_stored_documents)

            A --&gt; B
            B --&gt; C
            C --&gt; D
            D --&gt; E
        end

        subgraph Instantiation
            F(rabbithole_instantiates_parsers)
            G(rabbithole_instantiates_splitter)
            F --&gt; G
        end

        click A "/docs/plugins/hooks-reference/rabbit-hole/before_rabbithole_insert_memory"
        click B "/docs/plugins/hooks-reference/rabbit-hole/before_rabbithole_splits_text"
        click C "/docs/plugins/hooks-reference/rabbit-hole/after_rabbithole_splitted_text"
        click D "/docs/plugins/hooks-reference/rabbit-hole/before_rabbithole_stores_documents"
        click E "/docs/plugins/hooks-reference/rabbit-hole/after_rabbithole_stored_documents"
        click F "/docs/plugins/hooks-reference/rabbit-hole/rabbithole_instantiates_parsers"
        click G "/docs/plugins/hooks-reference/rabbit-hole/rabbithole_instantiates_splitter"</code></pre>
</div>
<div class="tabbed-block">
<div class="annotate" mardown="">
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Activated (1)</td>
<td style="text-align: left;">Intervene when a plugin is enabled</td>
</tr>
<tr>
<td style="text-align: left;">Deactivated (2)</td>
<td style="text-align: left;">Intervene when a plugin is disabled</td>
</tr>
<tr>
<td style="text-align: left;">Settings schema (3)</td>
<td style="text-align: left;">Override how the plugin's settings are retrieved</td>
</tr>
<tr>
<td style="text-align: left;">Settings model (4)</td>
<td style="text-align: left;">Override how the plugin's settings are retrieved</td>
</tr>
<tr>
<td style="text-align: left;">Load settings (5)</td>
<td style="text-align: left;">Override how the plugin's settings are loaded</td>
</tr>
<tr>
<td style="text-align: left;">Save settings (6)</td>
<td style="text-align: left;">Override how the plugin's settings are saved</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>
<p><strong>Input arguments</strong><br/>
<code>plugin</code>: the <code>Plugin</code> object of your plugin with the following properties:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">plugin</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="c1"># the path of your plugin </span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">plugin</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="c1"># the name of your plugin</span>
</span></code></pre></div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">plugin</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">cat.looking_glass.cheshire_cat</span> <span class="kn">import</span> <span class="n">CheshireCat</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="n">ccat</span> <span class="o">=</span> <span class="n">CheshireCat</span><span class="p">()</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="nd">@plugin</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="k">def</span> <span class="nf">activated</span><span class="p">(</span><span class="n">plugin</span><span class="p">):</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="c1"># Upload an url in the memory when the plugin is activated</span>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">url</span> <span class="o">=</span> <span class="s2">"https://cheshire-cat-ai.github.io/docs/technical/plugins/hooks/"</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">ccat</span><span class="o">.</span><span class="n">rabbit_hole</span><span class="o">.</span><span class="n">ingest_file</span><span class="p">(</span><span class="n">stray</span><span class="o">=</span><span class="n">ccat</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.activated">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
<li>
<p><strong>Input arguments</strong><br/>
<code>plugin</code>: the <code>Plugin</code> object of your plugin with the following properties:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">plugin</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="c1"># the path of your plugin </span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">plugin</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="c1"># the name of your plugin</span>
</span></code></pre></div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">plugin</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kn">from</span> <span class="nn">cat.looking_glass.cheshire_cat</span> <span class="kn">import</span> <span class="n">CheshireCat</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="n">ccat</span> <span class="o">=</span> <span class="n">CheshireCat</span><span class="p">()</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="nd">@plugin</span>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="k">def</span> <span class="nf">deactivated</span><span class="p">(</span><span class="n">plugin</span><span class="p">):</span>
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>    <span class="c1"># Scroll the declarative memory to clean from memories</span>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>    <span class="c1"># with metadata on plugin deactivation</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>    <span class="n">declarative_memory</span> <span class="o">=</span> <span class="n">ccat</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">declarative</span>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">declarative_memory</span><span class="o">.</span><span class="n">delete_points_by_metadata_filter</span><span class="p">(</span>
</span><span id="__span-3-13"><a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">"source"</span><span class="p">:</span> <span class="s2">"best_plugin"</span><span class="p">}</span>
</span><span id="__span-3-14"><a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>    <span class="p">)</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.deactivated">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
<li>
<p><strong>Input arguments</strong><br/>
    This hook has no input arguments.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Default <code>settings.json</code> is created by the cat core for the <em>settings fields</em> with default values.</p>
</div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">plugin</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># define your plugin settings model</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="k">class</span> <span class="nc">MySettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="n">prompt_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>                <span class="n">title</span><span class="o">=</span><span class="s2">"Prompt prefix"</span><span class="p">,</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>                <span class="n">default</span><span class="o">=</span><span class="s2">"""You are the Cheshire Cat AI, an intelligent AI that passes the Turing test.</span>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="s2">You are curious, funny and talk like the Cheshire Cat from Alice's adventures in wonderland.</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="s2">You answer Human with a focus on the following context.</span>
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="s2">"""</span><span class="p">,</span>
</span><span id="__span-4-12"><a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>                <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"TextArea"</span><span class="p">}</span>
</span><span id="__span-4-13"><a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>        <span class="p">)</span>
</span><span id="__span-4-14"><a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="n">episodic_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-4-15"><a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a>    <span class="n">episodic_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-4-16"><a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="n">declarative_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-4-17"><a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="n">declarative_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-4-18"><a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a>    <span class="n">procedural_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-4-19"><a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a>    <span class="n">procedural_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-4-20"><a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a>
</span><span id="__span-4-21"><a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="c1"># get your plugin settings schema</span>
</span><span id="__span-4-22"><a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="nd">@plugin</span>
</span><span id="__span-4-23"><a href="#__codelineno-4-23" id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="k">def</span> <span class="nf">settings_schema</span><span class="p">():</span>
</span><span id="__span-4-24"><a href="#__codelineno-4-24" id="__codelineno-4-24" name="__codelineno-4-24"></a>    <span class="k">return</span> <span class="n">MySettings</span><span class="o">.</span><span class="n">model_json_schema</span><span class="p">()</span>
</span><span id="__span-4-25"><a href="#__codelineno-4-25" id="__codelineno-4-25" name="__codelineno-4-25"></a>
</span><span id="__span-4-26"><a href="#__codelineno-4-26" id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="c1"># load your plugin settings</span>
</span><span id="__span-4-27"><a href="#__codelineno-4-27" id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="n">settings</span> <span class="o">=</span> <span class="n">ccat</span><span class="o">.</span><span class="n">mad_hatter</span><span class="o">.</span><span class="n">get_plugin</span><span class="p">()</span><span class="o">.</span><span class="n">load_settings</span><span class="p">()</span>
</span><span id="__span-4-28"><a href="#__codelineno-4-28" id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="c1"># access each setting</span>
</span><span id="__span-4-29"><a href="#__codelineno-4-29" id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="n">prompt_prefix</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"prompt_prefix"</span><span class="p">]</span>
</span><span id="__span-4-30"><a href="#__codelineno-4-30" id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="n">episodic_memory_k</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"episodic_memory_k"</span><span class="p">]</span>
</span><span id="__span-4-31"><a href="#__codelineno-4-31" id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="n">declarative_memory_k</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"declarative_memory_k"</span><span class="p">]</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://github.com/Furrmidable-Crew/cat_advanced_tools">Example Plugin: C.A.T. Cat Advanced Tools</a></li>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.settings_schema">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
<li>
<p><strong>Input arguments</strong><br/>
    This hook has no input arguments.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><code>settings_model</code> is preferred to <code>settings_schema</code>.</p>
<p>Default <code>settings.json</code> is created by the cat core for the <em>settings fields</em> with default values.</p>
</div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">plugin</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="c1"># define your plugin settings model</span>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="k">class</span> <span class="nc">MySettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-5-6"><a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>    <span class="n">prompt_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-5-7"><a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a>                <span class="n">title</span><span class="o">=</span><span class="s2">"Prompt prefix"</span><span class="p">,</span>
</span><span id="__span-5-8"><a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>                <span class="n">default</span><span class="o">=</span><span class="s2">"""You are the Cheshire Cat AI, an intelligent AI that passes the Turing test.</span>
</span><span id="__span-5-9"><a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="s2">You are curious, funny and talk like the Cheshire Cat from Alice's adventures in wonderland.</span>
</span><span id="__span-5-10"><a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="s2">You answer Human with a focus on the following context.</span>
</span><span id="__span-5-11"><a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="s2">"""</span><span class="p">,</span>
</span><span id="__span-5-12"><a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a>                <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"TextArea"</span><span class="p">}</span>
</span><span id="__span-5-13"><a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a>        <span class="p">)</span>
</span><span id="__span-5-14"><a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a>    <span class="n">episodic_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-5-15"><a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>    <span class="n">episodic_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-5-16"><a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a>    <span class="n">declarative_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-5-17"><a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>    <span class="n">declarative_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-5-18"><a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a>    <span class="n">procedural_memory_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-5-19"><a href="#__codelineno-5-19" id="__codelineno-5-19" name="__codelineno-5-19"></a>    <span class="n">procedural_memory_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="__span-5-20"><a href="#__codelineno-5-20" id="__codelineno-5-20" name="__codelineno-5-20"></a>
</span><span id="__span-5-21"><a href="#__codelineno-5-21" id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="c1"># get your plugin settings Pydantic model</span>
</span><span id="__span-5-22"><a href="#__codelineno-5-22" id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="nd">@plugin</span>
</span><span id="__span-5-23"><a href="#__codelineno-5-23" id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="k">def</span> <span class="nf">settings_model</span><span class="p">():</span>
</span><span id="__span-5-24"><a href="#__codelineno-5-24" id="__codelineno-5-24" name="__codelineno-5-24"></a>    <span class="k">return</span> <span class="n">MySettings</span>
</span><span id="__span-5-25"><a href="#__codelineno-5-25" id="__codelineno-5-25" name="__codelineno-5-25"></a>
</span><span id="__span-5-26"><a href="#__codelineno-5-26" id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="c1"># load your plugin settings</span>
</span><span id="__span-5-27"><a href="#__codelineno-5-27" id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="n">settings</span> <span class="o">=</span> <span class="n">ccat</span><span class="o">.</span><span class="n">mad_hatter</span><span class="o">.</span><span class="n">get_plugin</span><span class="p">()</span><span class="o">.</span><span class="n">load_settings</span><span class="p">()</span>
</span><span id="__span-5-28"><a href="#__codelineno-5-28" id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="c1"># access each setting</span>
</span><span id="__span-5-29"><a href="#__codelineno-5-29" id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="n">declarative_memory_k</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"declarative_memory_k"</span><span class="p">]</span>
</span><span id="__span-5-30"><a href="#__codelineno-5-30" id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="n">declarative_memory_threshold</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"declarative_memory_threshold"</span><span class="p">]</span>
</span><span id="__span-5-31"><a href="#__codelineno-5-31" id="__codelineno-5-31" name="__codelineno-5-31"></a><span class="n">procedural_memory_k</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">"procedural_memory_k"</span><span class="p">]</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.settings_model">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
<li>
<p><strong>Input arguments</strong><br/>
    This hook has no input arguments.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Useful to load settings via API and do custom stuff. E.g. load from a MongoDB instance.</p>
</div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="nd">@plugin</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="k">def</span> <span class="nf">load_settings</span><span class="p">():</span>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>    <span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">'mongodb://your_mongo_instance/'</span><span class="p">)</span>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="s1">'your_mongo_db'</span><span class="p">]</span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>    <span class="n">collection</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s1">'your_settings_collection'</span><span class="p">]</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>    <span class="c1"># Perform the find_one query</span>
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">'_id'</span><span class="p">:</span> <span class="s2">"your_plugin_id"</span><span class="p">})</span>
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>    <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>
</span><span id="__span-6-14"><a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="k">return</span> <span class="n">MySettings</span><span class="p">(</span><span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.load_settings">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
<li>
<p><strong>Input arguments</strong><br/>
<code>settings</code>: the settings <code>Dict</code> to be saved.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Useful for customizing the settings saving strategy. E.g. storing settings in a MongoDB instance.</p>
</div>
<details class="example">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="nd">@plugin</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">def</span> <span class="nf">save_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">):</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>    <span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">'mongodb://your_mongo_instance/'</span><span class="p">)</span>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="s1">'your_mongo_db'</span><span class="p">]</span>
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>    <span class="n">collection</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s1">'your_settings_collection'</span><span class="p">]</span>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>
</span><span id="__span-7-9"><a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>    <span class="c1"># Generic filter based on a unique identifier in settings</span>
</span><span id="__span-7-10"><a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a>    <span class="n">filter_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'_id'</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'_id'</span><span class="p">,</span> <span class="s1">'your_plugin_id'</span><span class="p">)}</span>
</span><span id="__span-7-11"><a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a>
</span><span id="__span-7-12"><a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a>    <span class="c1"># Define the update operation</span>
</span><span id="__span-7-13"><a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a>    <span class="n">update</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'$set'</span><span class="p">:</span> <span class="n">settings</span><span class="p">}</span>
</span><span id="__span-7-14"><a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a>
</span><span id="__span-7-15"><a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a>    <span class="c1"># Perform the upsert operation</span>
</span><span id="__span-7-16"><a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a>    <span class="n">collection</span><span class="o">.</span><span class="n">update_one</span><span class="p">(</span><span class="n">filter_id</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">upsert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-17"><a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a>
</span><span id="__span-7-18"><a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a>    <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div>
</details>
<details class="note">
<summary>Other resources</summary>
<ul>
<li><a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/settings/#cat.mad_hatter.core_plugin.settings.save_settings">Python reference</a></li>
<li><a href="https://github.com/cheshire-cat-ai/core/blob/main/core/cat/mad_hatter/plugin.py#L25">Plugin object</a></li>
</ul>
</details>
</li>
</ol>
<blockquote>
<p><strong><em>NOTE:</em></strong>  Any function in a plugin decorated by <code>@plugin</code> and named properly (among the list of available overrides, <strong>Plugin</strong> tab in the table above) is used to override plugin behaviour. These are not hooks because they are not piped, they are <em>specific</em> for every plugin.</p>
</blockquote>
</div>
<div class="tabbed-block">
<pre class="mermaid"><code>    flowchart TD
        A(factory_allowed_llms)
        B(factory_allowed_embedders)
        C(factory_allowed_auth_handlers)

        A --&gt; B
        B --&gt; C

        click A "/docs/plugins/hooks-reference/factory/factory_allowed_llms"
        click B "/docs/plugins/hooks-reference/factory/factory_allowed_embedders"
        click C "/docs/plugins/hooks-reference/factory/factory_allowed_auth_handlers"</code></pre>
</div>
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    B(before_cat_bootstrap)
    C(after_cat_bootstrap)
    B -- Cat components are loaded --&gt; C

    click B "/docs/plugins/hooks-reference/lifecycle/before_cat_bootstrap"
    click C "/docs/plugins/hooks-reference/lifecycle/after_cat_bootstrap"</code></pre>
</div>
</div>
</div>
<h2 id="how-the-hooks-work">How the Hooks work</h2>
<p>To create a hook, you first need to create a <a href="../plugins/">plugin</a> that contains it. Once the plugin is created, you can insert hooks inside the plugin, a single plugin can contain multiple hooks.</p>
<p>A hook is simply a Python function that uses the <code>@hook</code> decorator, the function's name determines when it will be called.</p>
<p>Each hook has its own signature name and arguments, the last argument being always <code>cat</code>, while the first one depends on the type of hook you're using.
Have a look at the table with all the <a href="#available-hooks">available hooks</a> and their <a href="https://cheshire-cat-ai.github.io/docs/API_Documentation/mad_hatter/core_plugin/hooks/agent/">detailed reference</a>.</p>
<h2 id="hook-declaration">Hook declaration</h2>
<p>The Cat comes already with a hook that defines his behaviour.<br/>
Let's take a look at it.
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nd">@hook</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="k">def</span> <span class="nf">agent_prompt_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="sd">"""Hook the main prompt prefix. """</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">"""You are the Cheshire Cat AI, an intelligent AI that passes </span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="s2">             the Turing test. You are curious, funny and talk like </span>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="s2">             the Cheshire Cat from Alice's adventures in wonderland.</span>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="s2">             You answer Human with a focus on the following context."""</span>
</span><span id="__span-8-8"><a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>
</span><span id="__span-8-9"><a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>    <span class="k">return</span> <span class="n">prefix</span>
</span></code></pre></div>
This hook returns the default prefix that describes who the AI is and how it is expected to answer the Human.
<h3 id="hook-arguments">Hook arguments</h3>
<p>When considering hooks' arguments, remember:</p>
<ul>
<li><code>cat</code> will always be present, as it allows you to use the framework components. It will be always the last one. See <a href="../../framework/cat-components/cheshire_cat/stray_cat/">here</a> for details and examples.
    <div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="nd">@hook</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">cat</span><span class="p">):</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>    <span class="k">pass</span>
</span></code></pre></div></li>
<li>the first argument other than <code>cat</code>, if present, will be a variable that you can edit and return back to the framework. Every hook passes a different data structure, which you need to know and be able to edit and return.
    <div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="nd">@hook</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>    <span class="c1"># edit data and return it</span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>    <span class="n">data</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="s2">"42"</span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>    <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div>
    You are free to return nothing and use the hook as a simple event callback.
    <div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="nd">@hook</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a>    <span class="n">do_my_thing</span><span class="p">()</span>
</span></code></pre></div></li>
<li>other arguments may be passed, serving only as additional context.
    <div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nd">@hook</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context_a</span><span class="p">,</span> <span class="n">context_b</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>    <span class="k">if</span> <span class="n">context_a</span> <span class="o">==</span> <span class="s2">"Caterpillar"</span><span class="p">:</span>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>        <span class="n">data</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="s2">"U R U"</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div></li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="before-cat-bootstrap">Before cat bootstrap</h3>
<p>You can use the <code>before_cat_bootstrap</code> hook to execute some operations before the Cat starts:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">hook</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="nd">@hook</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="k">def</span> <span class="nf">before_cat_bootstrap</span><span class="p">(</span><span class="n">cat</span><span class="p">):</span>
</span><span id="__span-13-5"><a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="n">do_my_thing</span><span class="p">()</span>
</span></code></pre></div>
<p>Notice in this hook there is only the <code>cat</code> argument, allowing you to use the llm and access other Cat components.<br/>
This is a pure event, with no additional arguments.</p>
<h3 id="before-cat-sends-message">Before cat sends message</h3>
<p>You can use the <code>before_cat_sends_message</code> hook to alter the message that the Cat will send to the user.
In this case you will receive both <code>final_output</code> and <code>cat</code> as arguments.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">cat.mad_hatter.decorators</span> <span class="kn">import</span> <span class="n">hook</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="nd">@hook</span>
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="k">def</span> <span class="nf">before_cat_sends_message</span><span class="p">(</span><span class="n">final_output</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-14-5"><a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>    <span class="c1"># You can edit the final_output the Cat is about to send back to the user</span>
</span><span id="__span-14-6"><a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a>    <span class="n">final_output</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">final_output</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="__span-14-7"><a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a>    <span class="k">return</span> <span class="n">final_output</span>
</span></code></pre></div>
<h2 id="hooks-chaining-and-priority">Hooks chaining and priority</h2>
<p>Several plugins can implement the same hook. The argument <code>priority</code> of the <code>@hook</code> decorator allows you to set the priority of the hook, the default value is 1.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nd">@hook</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># same as @hook without priority</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a>    <span class="k">pass</span>
</span></code></pre></div>
<p>The Cat calls hooks with the same name in order of <code>priority</code>. Hooks with a higher priority number will be called first. The following hook will receive the value returned by the previous hook. In this way, hooks can be chained together to create complex behaviors.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="c1"># plugin A</span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="nd">@hook</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="n">data</span><span class="o">.</span><span class="n">content</span> <span class="o">+=</span> <span class="s2">"Hello"</span>
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># plugin B</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="nd">@hook</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="k">def</span> <span class="nf">hook_name</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>    <span class="k">if</span> <span class="s2">"Hello"</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>        <span class="n">data</span><span class="o">.</span><span class="n">content</span> <span class="o">+=</span> <span class="s2">" world"</span>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>    <span class="k">return</span> <span class="n">data</span>
</span></code></pre></div>
<p>If two plugins have the same priority, the order in which they are called is not guaranteed.</p>
<h2 id="custom-hooks-in-plugins">Custom hooks in plugins</h2>
<p>You can define your own hooks, so other plugins can listen and interact with them.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1"># plugin cat_commerce</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="nd">@hook</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="k">def</span> <span class="nf">before_cat_reads_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a>    <span class="n">default_order</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a>        <span class="s2">"wool ball"</span><span class="p">,</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a>        <span class="s2">"catnip"</span>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a>    <span class="p">]</span>
</span><span id="__span-18-8"><a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a>    <span class="n">chain_output</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">mad_hatter</span><span class="o">.</span><span class="n">execute_hook</span><span class="p">(</span>
</span><span id="__span-18-9"><a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a>        <span class="s2">"cat_commerce_order"</span><span class="p">,</span> <span class="n">default_order</span><span class="p">,</span> <span class="n">cat</span><span class="o">=</span><span class="n">cat</span>
</span><span id="__span-18-10"><a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a>    <span class="p">)</span>
</span><span id="__span-18-11"><a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a>    <span class="n">do_my_thing</span><span class="p">(</span><span class="n">chain_output</span><span class="p">)</span>
</span></code></pre></div>
<p>Other plugins may be able to edit or just track the event:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># plugin A</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="nd">@hook</span>
</span><span id="__span-19-3"><a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="k">def</span> <span class="nf">cat_commerce_order</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-19-4"><a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a>    <span class="k">if</span> <span class="s2">"catnip"</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
</span><span id="__span-19-5"><a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a>        <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"free teacup"</span><span class="p">)</span>
</span><span id="__span-19-6"><a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a>    <span class="k">return</span> <span class="n">order</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># plugin B</span>
</span><span id="__span-20-2"><a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="nd">@hook</span>
</span><span id="__span-20-3"><a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="k">def</span> <span class="nf">cat_commerce_order</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
</span><span id="__span-20-4"><a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-20-5"><a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a>        <span class="c1"># updating working memory</span>
</span><span id="__span-20-6"><a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a>        <span class="n">cat</span><span class="o">.</span><span class="n">working_memory</span><span class="o">.</span><span class="n">bank_account</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-20-7"><a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a>        <span class="c1"># send websocket message</span>
</span><span id="__span-20-8"><a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a>        <span class="n">cat</span><span class="o">.</span><span class="n">send_ws_message</span><span class="p">(</span><span class="s2">"Cat is going broke"</span><span class="p">)</span>
</span></code></pre></div></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Tools" class="md-footer__link md-footer__link--prev" href="../tools/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Tools
              </div>
</div>
</a>
<a aria-label="Next: Forms" class="md-footer__link md-footer__link--next" href="../forms/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Forms
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/cheshire-cat-ai/core" rel="noopener" target="_blank" title="The Cheshire Cat repository on GitHub">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://discord.gg/bHX5sNFCYU" rel="noopener" target="_blank" title="The Cheshire Cat Discord Server">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.indexes", "navigation.footer", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "content.code.copy", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
</body>
</html>